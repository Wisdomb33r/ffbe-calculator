<h2 mat-dialog-title>{{'calculation.offensive.magicalDamagesCalculation' | translate}}</h2>
<mat-dialog-content>
  <h3>{{'calculation.offensive.skillHitsPower' | translate}}</h3>
  <table>
    <tr *ngIf="isChaining()">
      <td>{{'calculation.offensive.sparkChain' | translate}}</td>
      <td>
        <mat-checkbox [(ngModel)]="algorithm.isSparkChain" (change)="calculateBuild()"></mat-checkbox>
      </td>
    </tr>
    <tr>
      <td *ngIf="isChaining()">{{'calculation.offensive.comboIncrement' | translate}}</td>
      <td *ngIf="!isChaining()">{{'calculation.offensive.comboMultiplier' | translate}}</td>
      <td>{{result.combosIncrement | number:'1.1-1'}}</td>
    </tr>
    <tr>
      <td>{{'calculation.display.hits' | translate}}</td>
      <td>{{result.hitsPower.length}}</td>
    </tr>
  </table>
  <p><span *ngFor="let hitPower of result.hitsPower">{{hitPower | integer}}% </span></p>
  <h3>{{'calculation.offensive.turnPower' | translate}}</h3>
  <p>{{result.power | integer}}%</p>

  <h3>{{'calculation.display.calculationParameters' | translate}}</h3>
  <table>
    <tr>
      <td>{{result.calculationStat | translate}}</td>
      <td></td>
      <td>{{result[result.calculationStat] | integer}}</td>
    </tr>
    <tr>
      <td>{{'calculation.display.supportBuff' | translate}}</td>
      <td>
        <mat-checkbox [(ngModel)]="algorithm.isSupportBuffing" (change)="calculateBuild()"></mat-checkbox>
      </td>
      <td>
        <select [(ngModel)]="algorithm.supportBuff" (change)="calculateBuild()">
          <option value="40">40%</option>
          <option value="60">60%</option>
          <option value="80">80%</option>
          <option value="90">90%</option>
          <option value="100">100%</option>
          <option value="110">110%</option>
          <option value="120">120%</option>
          <option value="130">130%</option>
        </select></td>
    </tr>
    <tr>
      <td>{{'calculation.display.selfBuff' | translate}}</td>
      <td></td>
      <td>{{result.self_buff | integer}}%</td>
    </tr>
    <tr>
      <td>{{'calculation.display.buffed_' + result.calculationStat | translate}}</td>
      <td></td>
      <td>{{result['buffed_' + result.calculationStat] | integer}}</td>
    </tr>
    <tr>
      <td>{{'calculation.display.killer' | translate}}</td>
      <td>
        <mat-checkbox [(ngModel)]="algorithm.isKillerActive" (change)="calculateBuild()"></mat-checkbox>
      </td>
      <td>{{result.killerPassive | integer}}%</td>
    </tr>
    <tr *ngIf="result.elements && result.elements.length > 0">
      <td>{{'calculation.display.supportBreak' | translate}}</td>
      <td>
        <mat-checkbox [(ngModel)]="algorithm.isSupportBreakingResistances" (change)="calculateBuild()"></mat-checkbox>
      </td>
      <td>{{algorithm.supportResistsBreak[0] | integer}}%</td>
    </tr>
    <tr *ngIf="result.elements && result.elements.length > 0">
      <td>{{'calculation.display.resistances' | translate}}</td>
      <td>
        <div *ngFor="let element of result.elements" class="resist-icon">
          <img src="assets/resists/resist_{{element}}.png">
        </div>
      </td>
      <td>
        <div *ngFor="let element of result.elements" class="resist-label">
          {{result.resistances[element-1] | integer}}%
        </div>
      </td>
    </tr>
    <tr>
      <td>{{'calculation.display.opponentSpr' | translate}}</td>
      <td></td>
      <td>{{algorithm.opponentSpr | integer}}</td>
    </tr>
  </table>

  <h3>{{'calculation.offensive.baseDamages' | translate}}</h3>
  <p>
    {{result['buffed_' + result.calculationStat] | integer}}Â² * {{result.power | integer}}% * 2
  </p>
  <p>= {{result.magicalDamages | integer}}</p>

  <h3 *ngIf="result.killerPassive">{{'calculation.display.killerDamages' | translate}}</h3>
  <p *ngIf="result.killerPassive">
    {{result.magicalDamages | integer}} * (1+{{result.killerPassive}}%/10)
  </p>
  <p *ngIf="result.killerPassive">= {{result.magicalKillerDamages | integer}}</p>

  <h3 *ngIf="result.averageElementalResistance">{{'calculation.display.elementalResistances' | translate}}</h3>
  <p *ngIf="result.averageElementalResistance">
    {{result.magicalKillerDamages | integer}} * (1-({{result.averageElementalResistance}}%))
  </p>
  <p *ngIf="result.averageElementalResistance">= {{result.magicalElementalDamages | integer}}</p>

  <h3>{{'calculation.display.variances' | translate}}</h3>
  <p>{{result.magicalElementalDamages | integer}} * {{result.finalVariance}}% / {{algorithm.opponentSpr}}</p>
  <p>= <strong>{{result.magicalResult | integer}}</strong></p>
</mat-dialog-content>
